library(dplyr)
library(data.table)

dataset2016<-read.csv("newall2016.csv")
summary(dataset2016)
dataset2016<-dataset2016[-1]

tbl_df(dataset2016)
#split
library(caTools)
set.seed(555)
split = sample.split(dataset2016$loan_status, SplitRatio = 0.8)
training_set = subset(dataset2016, split == TRUE)
testset = subset(dataset2016, split == FALSE)
split = sample.split(dataset2016$loan_status, SplitRatio = 0.5)
test_set = subset(dataset2016, split == TRUE)
verifi_set = subset(dataset2016, split == FALSE)

#logistic
l_classifier <- glm(formula = loan_status ~.,
                    family = binomial,
                    data = training_set)
prob_pred = predict(l_classifier, type = 'response', 
                    newdata = test_set[-11])
l_pred = ifelse(prob_pred >= 0.4, 1, 0)
lcm = table(test_set[, 11], l_pred) #row is accuracy
lcm
lNA<-lcm[2,2]/(lcm[2,1]+lcm[2,2])
lPA<-lcm[1,1]/(lcm[1,2]+lcm[1,1])
l_accuracy<- sum(diag(lcm))/sum(lcm)
l_accuracy
LGM<- sqrt(lNA*lPA)
